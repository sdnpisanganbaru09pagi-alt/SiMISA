<!DOCTYPE html>
<html lang="id">
<head>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0ea5e9" />
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1,maximum-scale=1" name="viewport"/>
  <title>SiMISA â€” Aplikasi Peminjaman Aset Sekolah</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div aria-label="SiMISA Aplikasi Peminjaman Aset Sekolah" class="app" role="application">

  <!-- â”€â”€ Header â”€â”€ -->
  <header class="header">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <img alt="SiMISA logo" src="logo.webp" />
      </div>
      <div>
        <div class="title">SiMISA</div>
        <div class="subtitle">Aplikasi Peminjaman Aset Sekolah</div>
      </div>
    </div>
    <div class="header-actions"></div>
  </header>

  <!-- â”€â”€ Main â”€â”€ -->
  <main class="main">

    <!-- â”€â”€ Tabs â”€â”€ -->
    <nav aria-label="Main tabs" class="tabs" role="tablist">
      <button aria-selected="true" class="tab active" data-tab="dashboard" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></span>
        <span class="tab-label">Dashboard</span>
      </button>
      <button class="tab" data-tab="manage" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zm0 12H4V9h16v10zM13 5H11V3H9v2H7V3H5v2a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3h-2v2h-2V3h-2v2z"/></svg></span>
        <span class="tab-label">Kelola<br>Barang</span>
      </button>

      <button class="tab" data-tab="history" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 1 1 2.05 4.95L6.63 18.37A9 9 0 1 0 13 3zm-1 5v5l4.25 2.52.77-1.28-3.52-2.09V8H12z"/></svg></span>
        <span class="tab-label">Riwayat<br>Pinjam</span>
      </button>
      <button class="tab" data-tab="backup" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 4.02 2 6.5v11C2 19.98 6.48 22 12 22s10-2.02 10-4.5v-11C22 4.02 17.52 2 12 2zm8 15.5c0 1.38-3.58 2.5-8 2.5s-8-1.12-8-2.5V15c1.78 1.18 4.77 1.75 8 1.75s6.22-.57 8-1.75v2.5zm0-5c0 1.38-3.58 2.5-8 2.5s-8-1.12-8-2.5V10c1.78 1.18 4.77 1.75 8 1.75s6.22-.57 8-1.75v2.5zm-8-2.25C7.58 10.25 4 9.13 4 7.75S7.58 5.25 12 5.25s8 1.12 8 2.5-3.58 2.25-8 2.25z"/></svg></span>
        <span class="tab-label">Manajemen<br>Data</span>
      </button>
    </nav>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         DASHBOARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="view" id="dashboard" role="tabpanel">

      <!-- Stats -->
      <div class="stats" aria-hidden="false">
        <div class="stat">
          <div class="n" id="totalN">0</div>
          <div class="label">Total</div>
        </div>
        <div class="stat">
          <div class="n" id="availN">0</div>
          <div class="label">Tersedia</div>
        </div>
        <div class="stat">
          <div class="n" id="borrowedN">0</div>
          <div class="label">Dipinjam</div>
        </div>
      </div>

      <!-- Search -->
      <div class="search">
        <input aria-label="Cari barang" id="q" placeholder="Cari barang, kategori, peminjamâ€¦" type="search"/>
        <button class="btn ghost" id="clearSearch" title="Hapus pencarian">Bersihkan</button>
      </div>

      <!-- Filter chips -->
      <div class="actions chips" id="dashboardFilters">
        <button class="btn ghost active" data-dash-filter="all" type="button">Semua</button>
        <button class="btn ghost" data-dash-filter="available" type="button">Tersedia</button>
        <button class="btn ghost" data-dash-filter="borrowed" type="button">Dipinjam</button>
      </div>

      <!-- Item list -->
      <div aria-live="polite" class="list" id="items"></div>

    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         KELOLA BARANG
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="view" hidden id="manage">

      <!-- Add new item -->
      <div class="section-box">
        <div class="section-title">ğŸ“¦ Tambah Barang Baru</div>
        <form autocomplete="off" class="form" id="addForm">
          <div>
            <label for="name">Nama Barang</label>
            <input class="input" id="name" placeholder="Contoh: MacBook Pro" required type="text"/>
          </div>
          <div>
            <label for="category">Kategori</label>
            <input class="input" id="category" placeholder="Kategori (opsional)" type="text"/>
          </div>
          <div>
            <label for="desc">Deskripsi</label>
            <input class="input" id="desc" placeholder="Deskripsi singkat (opsional)" type="text"/>
          </div>
          <div class="hr"></div>
          <button class="btn primary" type="submit">Tambah Barang</button>
        </form>
      </div>

      <!-- Search + filter -->
      <div class="search">
        <input aria-label="Cari barang" id="manageSearch" placeholder="Cari barangâ€¦" type="search"/>
        <button class="btn ghost" id="clearManageSearch" title="Hapus pencarian">Bersihkan</button>
      </div>
      <div class="actions chips">
        <button class="btn ghost active" data-filter="all" type="button">Semua</button>
        <button class="btn ghost" data-filter="available" type="button">Tersedia</button>
        <button class="btn ghost" data-filter="borrowed" type="button">Dipinjam</button>
      </div>

      <!-- Manage list -->
      <div class="list" id="manageList"></div>

    </section>





    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         RIWAYAT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="view" hidden id="history">
      <div class="history-controls">
        <input class="wide-month" id="historyMonth" type="month"/>
        <button class="btn export-pdf" id="exportMonthPdf">ğŸ“„ Ekspor PDF</button>
      </div>
      <div class="list" id="historyList"></div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MANAJEMEN DATA
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="view" hidden id="backup">

      <!-- School settings -->
      <div class="section-box">
        <div class="section-title">ğŸ« Pengaturan Sekolah</div>
        <div class="form">
          <div>
            <label class="config-label" for="schoolName">Nama Sekolah</label>
            <input class="input" id="schoolName" placeholder="Masukkan nama sekolah" type="text"/>
          </div>
          <div>
            <label class="config-label" for="headmasterName">Nama Kepala Sekolah</label>
            <input class="input" id="headmasterName" placeholder="Masukkan nama kepala sekolah" type="text"/>
          </div>
          <div>
            <label class="config-label" for="headmasterNIP">NIP Kepala Sekolah</label>
            <input class="input" id="headmasterNIP" placeholder="Masukkan NIP kepala sekolah" type="text"/>
          </div>
          <p class="note">Data ini akan ditampilkan pada laporan PDF yang diekspor dari halaman Riwayat.</p>
        </div>
      </div>

      <!-- Data actions -->
      <div class="section-box">
        <div class="section-title">ğŸ’¼ Manajemen Data</div>
        <div class="horizontal-actions">
          <button class="btn export" id="exportBtn" title="Ekspor semua data">ğŸ’¾ Ekspor</button>
          <button class="btn import" id="importBtn" title="Impor data dari file">ğŸ“‚ Impor</button>
          <button class="btn danger" id="clearAll">ğŸ—‘ï¸ Hapus</button>
        </div>
      </div>

    </section>

  </main>

  <!-- â”€â”€ Footer â”€â”€ -->
  <footer class="footer">
    <div class="small">Data disimpan di perangkat Anda.</div>
    <div class="small">Dikembangkan oleh: Twin Insani, S.Kom</div>
  </footer>


  <!-- â•â• Modal Peminjaman â•â• -->
  <div class="form-modal" id="borrowModal" hidden aria-modal="true" role="dialog" aria-labelledby="borrowModalTitle">
    <div class="form-modal-backdrop"></div>
    <div class="form-modal-sheet">
      <div class="form-modal-drag-handle" id="borrowDragHandle"></div>
      <div class="form-modal-header">
        <div class="form-modal-title" id="borrowModalTitle">ğŸ“¤ Catat Peminjaman</div>
        <button class="form-modal-close" id="closeBorrowModal" aria-label="Tutup">âœ•</button>
      </div>
      <div class="form-modal-body">
        <form class="form" id="borrowForm" autocomplete="off">
          <div>
            <label for="borrowSelect">Pilih Barang</label>
            <select class="select" id="borrowSelect" required>
              <option value="">Pilih barang yang tersediaâ€¦</option>
            </select>
          </div>
          <div>
            <label for="borrower">Nama Peminjam</label>
            <input class="input" id="borrower" placeholder="Nama lengkap peminjam" required type="text"/>
          </div>
          <div>
            <label for="borrowDate">Tanggal Peminjaman</label>
            <input class="input" id="borrowDate" required type="date"/>
          </div>
          <div>
            <label for="expectedReturn">Perkiraan Pengembalian</label>
            <input class="input" id="expectedReturn" placeholder="Perkiraan pengembalian (opsional)" type="date"/>
          </div>
          <div>
            <label>Foto Peminjaman</label>
            <div class="photo-upload-container" id="borrowPhotoContainer">
              <input accept="image/*" capture="environment" id="borrowPhoto" name="borrowPhoto" type="file"/>
              <div class="upload-placeholder">
                <div class="upload-icon">ğŸ“·</div>
                <p>Ambil Foto</p>
                <small>Ketuk untuk ambil foto bukti peminjaman</small>
              </div>
              <div class="photo-preview" id="borrowPreview"></div>
            </div>
          </div>
          <div class="hr"></div>
          <button class="btn primary full" type="submit">Catat Peminjaman</button>
        </form>
      </div>
    </div>
  </div>

  <!-- â•â• Modal Pengembalian â•â• -->
  <div class="form-modal" id="returnModal" hidden aria-modal="true" role="dialog" aria-labelledby="returnModalTitle">
    <div class="form-modal-backdrop"></div>
    <div class="form-modal-sheet">
      <div class="form-modal-drag-handle" id="returnDragHandle"></div>
      <div class="form-modal-header">
        <div class="form-modal-title" id="returnModalTitle">ğŸ“¥ Catat Pengembalian</div>
        <button class="form-modal-close" id="closeReturnModal" aria-label="Tutup">âœ•</button>
      </div>
      <div class="form-modal-body">
        <form class="form" id="returnForm" autocomplete="off">
          <div>
            <label for="returnSelect">Pilih Barang</label>
            <select class="select" id="returnSelect" required>
              <option value="">Pilih barang yang dipinjamâ€¦</option>
            </select>
          </div>
          <div>
            <label for="returnDate">Tanggal Pengembalian</label>
            <input class="input" id="returnDate" required type="date"/>
          </div>
          <div>
            <label>Foto Pengembalian</label>
            <div class="photo-upload-container" id="returnPhotoContainer">
              <input accept="image/*" capture="environment" id="returnPhoto" name="returnPhoto" type="file"/>
              <div class="upload-placeholder">
                <div class="upload-icon">ğŸ“·</div>
                <p>Ambil Foto</p>
                <small>Ketuk untuk ambil foto bukti pengembalian</small>
              </div>
              <div class="photo-preview" id="returnPreview"></div>
            </div>
          </div>
          <div class="hr"></div>
          <button class="btn primary full" type="submit">Catat Pengembalian</button>
        </form>
      </div>
    </div>
  </div>

</div><!-- /.app -->

<!-- Progress overlay -->
<div id="progressOverlay" style="display:none;">
  <div>
    <div id="progressText" style="margin-bottom:12px;font-weight:700;">Proses Berjalanâ€¦</div>
    <div style="background:#e0f2fe;border-radius:8px;overflow:hidden;height:16px;">
      <div id="progressBar" style="height:100%;width:0%;transition:width 0.3s;"></div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="jspdf.umd.min.js"></script>
<script src="jspdf.plugin.autotable.min.js"></script>
<script src="app.js"></script>
<script src="fallback.js"></script>

<!-- Tab navigation â€” replaces old .tab click handler -->
<script>
(function(){
  // Wire tabs: toggle .active and show/hide views
  document.querySelectorAll('.tab[data-tab]').forEach(function(btn){
    btn.addEventListener('click', function(){
      if(typeof showView === 'function') showView(btn.dataset.tab);
    });
  });

  // Dashboard filter chips
  document.querySelectorAll('[data-dash-filter]').forEach(function(btn){
    btn.addEventListener('click', function(){
      document.querySelectorAll('[data-dash-filter]').forEach(function(b){
        b.classList.remove('active');
      });
      btn.classList.add('active');
      if(typeof dashboardFilter !== 'undefined'){
        dashboardFilter = btn.dataset.dashFilter;
      }
      if(typeof renderDashboardList === 'function') renderDashboardList();
    });
  });
})();
</script>

</body>
</html>