<!DOCTYPE html>
<html lang="id">
<head>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0ea5e9" />
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1,maximum-scale=1" name="viewport"/>
  <title>SiMISA ‚Äî Aplikasi Peminjaman Aset Sekolah</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div aria-label="SiMISA Aplikasi Peminjaman Aset Sekolah" class="app" role="application">

  <!-- ‚îÄ‚îÄ Header ‚îÄ‚îÄ -->
  <header class="header">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <img alt="SiMISA logo" src="logo.webp" />
      </div>
      <div>
        <div class="title">SiMISA</div>
        <div class="subtitle">Aplikasi Peminjaman Aset Sekolah</div>
      </div>
    </div>
    <div class="header-actions"></div>
  </header>

  <!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
  <main class="main">

    <!-- ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ -->
    <nav aria-label="Main tabs" class="tabs" role="tablist">
      <button aria-selected="true" class="tab active" data-tab="dashboard" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></span>
        <span class="tab-label">Dashboard</span>
      </button>
      <button class="tab" data-tab="manage" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zm0 12H4V9h16v10zM13 5H11V3H9v2H7V3H5v2a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3h-2v2h-2V3h-2v2z"/></svg></span>
        <span class="tab-label">Kelola<br>Barang</span>
      </button>

      <button class="tab" data-tab="history" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6a7 7 0 1 1 2.05 4.95L6.63 18.37A9 9 0 1 0 13 3zm-1 5v5l4.25 2.52.77-1.28-3.52-2.09V8H12z"/></svg></span>
        <span class="tab-label">Riwayat<br>Pinjam</span>
      </button>
      <button class="tab" data-tab="backup" role="tab">
        <span class="tab-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 4.02 2 6.5v11C2 19.98 6.48 22 12 22s10-2.02 10-4.5v-11C22 4.02 17.52 2 12 2zm8 15.5c0 1.38-3.58 2.5-8 2.5s-8-1.12-8-2.5V15c1.78 1.18 4.77 1.75 8 1.75s6.22-.57 8-1.75v2.5zm0-5c0 1.38-3.58 2.5-8 2.5s-8-1.12-8-2.5V10c1.78 1.18 4.77 1.75 8 1.75s6.22-.57 8-1.75v2.5zm-8-2.25C7.58 10.25 4 9.13 4 7.75S7.58 5.25 12 5.25s8 1.12 8 2.5-3.58 2.25-8 2.25z"/></svg></span>
        <span class="tab-label">Manajemen<br>Data</span>
      </button>
    </nav>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         DASHBOARD
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="view" id="dashboard" role="tabpanel">

      <!-- Stats -->
      <div class="stats" aria-hidden="false">
        <div class="stat">
          <div class="n" id="totalN">0</div>
          <div class="label">Total</div>
        </div>
        <div class="stat">
          <div class="n" id="availN">0</div>
          <div class="label">Tersedia</div>
        </div>
        <div class="stat">
          <div class="n" id="borrowedN">0</div>
          <div class="label">Dipinjam</div>
        </div>
      </div>

      <!-- Search -->
      <div class="search">
        <input aria-label="Cari barang" id="q" placeholder="Cari barang, kategori, peminjam‚Ä¶" type="search"/>
        <button class="btn ghost" id="clearSearch" title="Hapus pencarian">Bersihkan</button>
      </div>

      <!-- Filter chips -->
      <div class="actions chips" id="dashboardFilters">
        <button class="btn ghost active" data-dash-filter="all" type="button">Semua</button>
        <button class="btn ghost" data-dash-filter="available" type="button">Tersedia</button>
        <button class="btn ghost" data-dash-filter="borrowed" type="button">Dipinjam</button>
      </div>

      <!-- Item list -->
      <div aria-live="polite" class="list" id="items"></div>

    </section>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         KELOLA BARANG
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="view" hidden id="manage">

      <!-- Add new item -->
      <div class="section-box">
        <div class="section-title">üì¶ Tambah Barang Baru</div>
        <form autocomplete="off" class="form" id="addForm">
          <div>
            <label for="name">Nama Barang</label>
            <input class="input" id="name" placeholder="Contoh: MacBook Pro" required type="text"/>
          </div>
          <div>
            <label for="category">Kategori</label>
            <input class="input" id="category" placeholder="Kategori (opsional)" type="text"/>
          </div>
          <div>
            <label for="desc">Deskripsi</label>
            <input class="input" id="desc" placeholder="Deskripsi singkat (opsional)" type="text"/>
          </div>
          <div class="hr"></div>
          <button class="btn primary" type="submit">Tambah Barang</button>
        </form>
      </div>

      <!-- Search + filter -->
      <div class="search">
        <input aria-label="Cari barang" id="manageSearch" placeholder="Cari barang‚Ä¶" type="search"/>
        <button class="btn ghost" id="clearManageSearch" title="Hapus pencarian">Bersihkan</button>
      </div>
      <div class="actions chips">
        <button class="btn ghost active" data-filter="all" type="button">Semua</button>
        <button class="btn ghost" data-filter="available" type="button">Tersedia</button>
        <button class="btn ghost" data-filter="borrowed" type="button">Dipinjam</button>
      </div>

      <!-- Manage list -->
      <div class="list" id="manageList"></div>

    </section>





    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         RIWAYAT
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="view" hidden id="history">
      <div class="history-controls">
        <input class="wide-month" id="historyMonth" type="month"/>
        <button class="btn export-pdf" id="exportMonthPdf">üìÑ Ekspor PDF</button>
      </div>
      <div class="list" id="historyList"></div>
    </section>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         MANAJEMEN DATA
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <section class="view" hidden id="backup">

      <!-- School settings -->
      <div class="section-box">
        <div class="section-title">üè´ Pengaturan Sekolah</div>
        <div class="form">
          <div>
            <label class="config-label" for="schoolName">Nama Sekolah</label>
            <input class="input" id="schoolName" placeholder="Masukkan nama sekolah" type="text"/>
          </div>
          <div>
            <label class="config-label" for="headmasterName">Nama Kepala Sekolah</label>
            <input class="input" id="headmasterName" placeholder="Masukkan nama kepala sekolah" type="text"/>
          </div>
          <div>
            <label class="config-label" for="headmasterNIP">NIP Kepala Sekolah</label>
            <input class="input" id="headmasterNIP" placeholder="Masukkan NIP kepala sekolah" type="text"/>
          </div>
          <p class="note">Data ini akan ditampilkan pada laporan PDF yang diekspor dari halaman Riwayat.</p>
        </div>
      </div>

      <!-- Data actions -->
      <div class="section-box">
        <div class="section-title">üíº Manajemen Data</div>
        <div class="horizontal-actions">
          <button class="btn export" id="exportBtn" title="Ekspor semua data">üíæ Ekspor</button>
          <button class="btn import" id="importBtn" title="Impor data dari file">üìÇ Impor</button>
          <button class="btn danger" id="clearAll">üóëÔ∏è Hapus</button>
        </div>
      </div>

    </section>

  </main>

  <!-- ‚îÄ‚îÄ Footer ‚îÄ‚îÄ -->
  <footer class="footer">
    <div class="small">Data disimpan di perangkat Anda.</div>
    <div class="small">Dikembangkan oleh: Twin Insani, S.Kom</div>
  </footer>


  <!-- ‚ïê‚ïê Modal Peminjaman ‚ïê‚ïê -->
  <div class="form-modal" id="borrowModal" aria-modal="true" role="dialog" aria-labelledby="borrowModalTitle">
    <div class="form-modal-sheet">
      <div class="form-modal-drag-handle" id="borrowDragHandle"></div>
      <div class="form-modal-header">
        <div class="form-modal-title" id="borrowModalTitle">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9 5v2H6.5l-.94 8.45A2 2 0 0 0 7.54 18h8.92a2 2 0 0 0 1.98-2.55L17.5 7H15V5a3 3 0 0 0-6 0m2 0a1 1 0 0 1 2 0v2h-2V5M7 20h10v2H7v-2Z"/></svg>
          Catat Peminjaman
        </div>
        <button class="form-modal-close" id="closeBorrowModal" aria-label="Tutup">‚úï</button>
      </div>
      <div class="modal-item-info" id="borrowItemInfo"></div>
      <div class="form-modal-body">
        <form class="form" id="borrowForm" autocomplete="off">

          <label style="display:none">
            <select class="select" id="borrowSelect" required>
              <option value="">Pilih barang yang tersedia‚Ä¶</option>
            </select>
          </label>

          <label>
            <div class="field-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
              Nama Peminjam
            </div>
            <input class="input" id="borrower" placeholder="Nama lengkap peminjam" required type="text"/>
          </label>

          <label style="display:none"><input class="input" id="borrowDate" required type="date"/></label>

          <label>
            <div class="field-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67V7z"/></svg>
              Perkiraan Pengembalian <span style="font-weight:400;color:var(--text-3)">(opsional)</span>
            </div>
            <input class="input" id="expectedReturn" type="date"/>
          </label>

          <label>
            <div class="field-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 15.2A3.2 3.2 0 0 1 8.8 12 3.2 3.2 0 0 1 12 8.8 3.2 3.2 0 0 1 15.2 12 3.2 3.2 0 0 1 12 15.2M9 2 7.17 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-3.17L15 2Z"/></svg>
              Foto Peminjaman
            </div>
            <div class="photo-upload-container" id="borrowPhotoContainer">
              <input accept="image/*" capture="environment" id="borrowPhoto" name="borrowPhoto" type="file"/>
              <div class="upload-placeholder">
                <div class="upload-icon">üì∑</div>
                <p>Ambil Foto</p>
                <small>Ketuk untuk ambil foto bukti peminjaman</small>
              </div>
              <div class="photo-preview" id="borrowPreview"></div>
            </div>
          </label>

          <div class="modal-actions">
            <button class="btn ghost" type="button" id="cancelBorrowBtn" style="flex:1">Batal</button>
            <button class="btn primary" type="submit" style="flex:1">Catat Peminjaman</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê Modal Pengembalian ‚ïê‚ïê -->
  <div class="form-modal" id="returnModal" aria-modal="true" role="dialog" aria-labelledby="returnModalTitle">
    <div class="form-modal-sheet">
      <div class="form-modal-drag-handle" id="returnDragHandle"></div>
      <div class="form-modal-header">
        <div class="form-modal-title" id="returnModalTitle">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7h-2z"/></svg>
          Catat Pengembalian
        </div>
        <button class="form-modal-close" id="closeReturnModal" aria-label="Tutup">‚úï</button>
      </div>
      <div class="modal-item-info" id="returnItemInfo"></div>
      <div class="form-modal-body">
        <form class="form" id="returnForm" autocomplete="off">

          <label style="display:none">
            <select class="select" id="returnSelect" required>
              <option value="">Pilih barang yang dipinjam‚Ä¶</option>
            </select>
          </label>

          <label style="display:none"><input class="input" id="returnDate" required type="date"/></label>

          <label>
            <div class="field-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 15.2A3.2 3.2 0 0 1 8.8 12 3.2 3.2 0 0 1 12 8.8 3.2 3.2 0 0 1 15.2 12 3.2 3.2 0 0 1 12 15.2M9 2 7.17 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-3.17L15 2Z"/></svg>
              Foto Pengembalian
            </div>
            <div class="photo-upload-container" id="returnPhotoContainer">
              <input accept="image/*" capture="environment" id="returnPhoto" name="returnPhoto" type="file"/>
              <div class="upload-placeholder">
                <div class="upload-icon">üì∑</div>
                <p>Ambil Foto</p>
                <small>Ketuk untuk ambil foto bukti pengembalian</small>
              </div>
              <div class="photo-preview" id="returnPreview"></div>
            </div>
          </label>

          <div class="modal-actions">
            <button class="btn ghost" type="button" id="cancelReturnBtn" style="flex:1">Batal</button>
            <button class="btn primary" type="submit" style="flex:1">Catat Pengembalian</button>
          </div>
        </form>
      </div>
    </div>
  </div>

</div><!-- /.app -->

<!-- Progress overlay -->
<div id="progressOverlay" style="display:none;">
  <div>
    <div id="progressText" style="margin-bottom:12px;font-weight:700;">Proses Berjalan‚Ä¶</div>
    <div style="background:#e0f2fe;border-radius:8px;overflow:hidden;height:16px;">
      <div id="progressBar" style="height:100%;width:0%;transition:width 0.3s;"></div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="jspdf.umd.min.js"></script>
<script src="jspdf.plugin.autotable.min.js"></script>
<script src="app.js"></script>
<script src="fallback.js"></script>

<!-- Tab navigation ‚Äî replaces old .tab click handler -->
<script>
(function(){
  // Wire tabs: toggle .active and show/hide views
  document.querySelectorAll('.tab[data-tab]').forEach(function(btn){
    btn.addEventListener('click', function(){
      if(typeof showView === 'function') showView(btn.dataset.tab);
    });
  });

  // Dashboard filter chips
  document.querySelectorAll('[data-dash-filter]').forEach(function(btn){
    btn.addEventListener('click', function(){
      document.querySelectorAll('[data-dash-filter]').forEach(function(b){
        b.classList.remove('active');
      });
      btn.classList.add('active');
      if(typeof dashboardFilter !== 'undefined'){
        dashboardFilter = btn.dataset.dashFilter;
      }
      if(typeof renderDashboardList === 'function') renderDashboardList();
    });
  });
})();
</script>

</body>
</html>